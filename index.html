<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¢ Ù…ÙƒØªØ¨ Ù…Ø§Ø³ØªØ± Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª</title>
    <style>
        /* Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ø¹Ø§Ù… Ù„Ù„ØµÙØ­Ø© */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1, h2, h3 {
            margin: 0 0 15px 0;
        }

        /* Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .login-container {
            max-width: 450px;
            margin: 5% auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {opacity: 0; transform: translateY(-20px);}
            to {opacity: 1; transform: translateY(0);}
        }

        .login-header {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .login-form {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 15px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(52, 152, 219, 0.4);
        }

        .create-account-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            text-align: center;
        }

        .create-account-btn {
            background: linear-gradient(135deg, #27ae60, #219a52);
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .create-account-btn:hover {
            box-shadow: 0 8px 15px rgba(39, 174, 96, 0.4);
        }

        /* Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-container {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {opacity: 0; transform: translateY(20px);}
            to {opacity: 1; transform: translateY(0);}
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filters-section {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            min-width: 150px;
            width: 100%;
        }

        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #bd2130);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #d39e00);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border: 2px solid transparent;
        }

        .summary-card:hover {
            transform: translateY(-8px);
            border-color: #3498db;
        }

        .summary-card h3 {
            color: #495057;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .summary-card .value {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }

        /* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .table-container {
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th, td {
            border: 1px solid #dee2e6;
            padding: 12px 8px;
            text-align: center;
        }

        th {
            background: linear-gradient(135deg, #495057, #6c757d);
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:hover {
            background-color: #e3f2fd;
            transform: scale(1.005);
            transition: all 0.2s ease;
        }

        .status-cell {
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 20px;
        }

        .status-paid {
            background: #d4edda;
            color: #155724;
        }

        .status-partial {
            background: #fff3cd;
            color: #856404;
        }

        .status-unpaid {
            background: #f8d7da;
            color: #721c24;
        }

        /* Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            animation: modalSlideIn 0.4s ease-out;
        }

        @keyframes modalSlideIn {
            from {opacity: 0;transform: scale(0.8);}
            to {opacity: 1;transform: scale(1);}
        }

        .close {
            color: #aaa;
            float: left;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #e74c3c;
        }

        /* Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
        .alert {
            padding: 15px;
            margin: 20px 0;
            border: 1px solid transparent;
            border-radius: 8px;
            font-weight: bold;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .alert-error {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        /* Ø§Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 768px) {
            .controls, .filters-section {
                flex-direction: column;
                align-items: stretch;
            }
            .btn {
                width: 100%;
                margin-bottom: 5px;
            }
            table {
                font-size: 12px;
            }
            th, td {
                padding: 8px 4px;
            }
            .header {
                flex-direction: column;
                text-align: center;
            }
            .header-right {
                justify-content: center;
            }
        }
    </style>
</head>
<body>

<!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="loginScreen" class="login-container">
    <div class="login-header">
        <h1>ğŸ¢ Ù…ÙƒØªØ¨ Ù…Ø§Ø³ØªØ± Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª</h1>
        <p>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</p>
    </div>
    <div class="login-form">
        <div id="loginAlert"></div>
        <form id="loginForm">
            <div class="form-group">
                <label>ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                <input type="text" id="loginUsername" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label>ğŸ”’ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                <input type="password" id="loginPassword" required placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <button type="submit" class="login-btn">ğŸš€ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </form>
        <div class="create-account-section">
            <p>Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ</p>
            <button class="create-account-btn" onclick="showCreateAccount()">â• Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
        </div>
    </div>
</div>

<!-- Ø´Ø§Ø´Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ -->
<div id="createAccountScreen" class="login-container hidden">
    <div class="login-header">
        <h1>ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h1>
        <p>Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯</p>
    </div>
    <div class="login-form">
        <div id="createAlert"></div>
        <form id="createAccountForm">
            <div class="form-group">
                <label>ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                <input type="text" id="createUsername" required placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label>ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
                <input type="email" id="createEmail" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
            </div>
            <div class="form-group">
                <label>ğŸ”’ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                <input type="password" id="createPassword" required placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©">
            </div>
            <div class="form-group">
                <label>ğŸ”’ ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                <input type="password" id="confirmPassword" required placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <button type="submit" class="login-btn">âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
            <button type="button" class="login-btn btn-secondary" style="background: #6c757d; margin-top: 10px;" onclick="showLogin()">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </form>
    </div>
</div>

<!-- Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div id="mainScreen" class="main-container">
    <div class="header">
        <div class="header-left">
            <h1>ğŸ“Š Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© ÙˆÙ…ØªØ·ÙˆØ±Ø© Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</p>
        </div>
        <div class="header-right">
            <div class="user-info">ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="currentUserName" style="font-weight: bold;"></span></div>
            <button class="logout-btn" onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>

    <!-- ÙÙ„Ø§ØªØ± Ø§Ù„Ø¨Ø­Ø« -->
    <div class="filters-section">
        <input type="text" id="searchFilter" class="filter-input" placeholder="ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„...">
        <select id="statusFilter" class="filter-input">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
            <option value="Ù…Ø¯ÙÙˆØ¹">Ù…Ø¯ÙÙˆØ¹</option>
            <option value="Ø¬Ø²Ø¦ÙŠ">Ø¬Ø²Ø¦ÙŠ</option>
            <option value="Ù„Ù… ÙŠØ¯ÙØ¹">Ù„Ù… ÙŠØ¯ÙØ¹</option>
        </select>
        <select id="paymentMethodFilter" class="filter-input">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹</option>
            <option value="Ù†Ù‚Ø¯ÙŠ">Ù†Ù‚Ø¯ÙŠ</option>
            <option value="Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ">Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ</option>
            <option value="ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</option>
        </select>
        <button class="btn btn-primary" onclick="updateWorkersTable()">ğŸ” ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±</button>
        <button class="btn btn-warning" onclick="clearFilters()">ğŸ”„ Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±</button>
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
    <div class="filters-section">
        <button class="btn btn-success" onclick="addWorker()">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
        <button class="btn btn-primary" onclick="exportToExcel()">ğŸ“¥ ØªØµØ¯ÙŠØ± Ø¥ÙƒØ³Ù„</button>
        <button class="btn btn-primary" onclick="exportToJSON()">ğŸ’¾ ØªØµØ¯ÙŠØ± JSON</button>
        <button class="btn btn-danger" onclick="clearAll()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
    </div>

    <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù… -->
    <div class="summary-cards">
        <div class="summary-card">
            <div class="icon">ğŸ‘¥</div>
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3>
            <div class="value" id="totalWorkers">0</div>
        </div>
        <div class="summary-card">
            <div class="icon">ğŸ“‹</div>
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h3>
            <div class="value" id="totalReports">0</div>
        </div>
        <div class="summary-card">
            <div class="icon">ğŸ’°</div>
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨</h3>
            <div class="value" id="totalAmount">0 Ø¬Ù†ÙŠÙ‡</div>
        </div>
        <div class="summary-card">
            <div class="icon">âœ…</div>
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹</h3>
            <div class="value" id="totalPaid">0 Ø¬Ù†ÙŠÙ‡</div>
        </div>
        <div class="summary-card">
            <div class="icon">ğŸ’¸</div>
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©</h3>
            <div class="value" id="totalCommission">0 Ø¬Ù†ÙŠÙ‡</div>
        </div>
        <div class="summary-card">
            <div class="icon">ğŸ’µ</div>
            <h3>ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹</h3>
            <div class="value" id="totalNetPaid">0 Ø¬Ù†ÙŠÙ‡</div>
        </div>
        <div class="summary-card">
            <div class="icon">â³</div>
            <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</h3>
            <div class="value" id="totalRemaining">0 Ø¬Ù†ÙŠÙ‡</div>
        </div>
        <div class="summary-card">
            <div class="icon">ğŸ“ˆ</div>
            <h3>Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ØµÙŠÙ„</h3>
            <div class="value" id="collectionRate">0%</div>
        </div>
    </div>

    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    <div class="table-container">
        <table id="workersTable">
            <thead>
                <tr>
                    <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                    <th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</th>
                    <th>Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø±ÙŠØ± (Ø¬Ù†ÙŠÙ‡)</th>
                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨ (Ø¬Ù†ÙŠÙ‡)</th>
                    <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ (Ø¬Ù†ÙŠÙ‡)</th>
                    <th>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</th>
                    <th>Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø³Ø­Ø¨ (Ø¬Ù†ÙŠÙ‡)</th>
                    <th>ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹ (Ø¬Ù†ÙŠÙ‡)</th>
                    <th>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (Ø¬Ù†ÙŠÙ‡)</th>
                    <th>Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹</th>
                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©</th>
                    <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody id="workersTableBody"></tbody>
            <tfoot>
                <tr class="total-row">
                    <td><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</strong></td>
                    <td><strong id="totalReportsFooter">0</strong></td>
                    <td>-</td>
                    <td><strong id="totalAmountFooter">0 Ø¬Ù†ÙŠÙ‡</strong></td>
                    <td><strong id="totalPaidFooter">0 Ø¬Ù†ÙŠÙ‡</strong></td>
                    <td>-</td>
                    <td><strong id="totalCommissionFooter">0 Ø¬Ù†ÙŠÙ‡</strong></td>
                    <td><strong id="totalNetPaidFooter">0 Ø¬Ù†ÙŠÙ‡</strong></td>
                    <td><strong id="totalRemainingFooter">0 Ø¬Ù†ÙŠÙ‡</strong></td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>

<!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ -->
<div id="workerModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h2>
        <form id="workerForm" style="margin-top: 20px;">
            <div style="margin-bottom: 15px;">
                <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„:</label>
                <input type="text" id="workerName" required style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±:</label>
                <input type="number" id="reportCount" min="0" required style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø±ÙŠØ± (Ø¬Ù†ÙŠÙ‡):</label>
                <input type="number" id="reportPrice" min="0" required style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ (Ø¬Ù†ÙŠÙ‡):</label>
                <input type="number" id="paidAmount" min="0" value="0" style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</label>
                <select id="paymentMethod" style="margin-top: 5px; width: 100%; padding: 8px;">
                    <option value="Ù†Ù‚Ø¯ÙŠ">Ù†Ù‚Ø¯ÙŠ</option>
                    <option value="Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ">Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ</option>
                    <option value="ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</option>
                </select>
            </div>
            <button type="submit" class="btn btn-success" style="width: 100%;">âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
        </form>
    </div>
</div>

<!-- Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
<div id="workerEditModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeEditModal()">&times;</span>
        <h2>âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h2>
        <form id="workerEditForm" style="margin-top: 20px;">
            <input type="hidden" id="workerId">
            <div style="margin-bottom: 15px;">
                <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„:</label>
                <input type="text" id="workerNameEdit" required style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±:</label>
                <input type="number" id="reportCountEdit" min="0" required style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø³Ø¹Ø± Ø§Ù„ØªÙ‚Ø±ÙŠØ± (Ø¬Ù†ÙŠÙ‡):</label>
                <input type="number" id="reportPriceEdit" min="0" required style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ (Ø¬Ù†ÙŠÙ‡):</label>
                <input type="number" id="paidAmountEdit" min="0" value="0" style="margin-top: 5px;">
            </div>
            <div style="margin-bottom: 15px;">
                <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</label>
                <select id="paymentMethodEdit" style="margin-top: 5px; width: 100%; padding: 8px;">
                    <option value="Ù†Ù‚Ø¯ÙŠ">Ù†Ù‚Ø¯ÙŠ</option>
                    <option value="Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ">Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ</option>
                    <option value="ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</option>
                </select>
            </div>
            <button type="submit" class="btn btn-success" style="width: 100%;">âœ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
        </form>
    </div>
</div>

<!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª -->
<div id="createAlert" style="padding: 20px;"></div>

<script>
    // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    class DataManager {
        constructor() {
            this.users = this.loadUsers();
            this.currentUser = null;
            this.userData = {};
        }

        loadUsers() {
            return JSON.parse(localStorage.getItem('masterOfficeUsers') || '{}');
        }

        saveUsers() {
            localStorage.setItem('masterOfficeUsers', JSON.stringify(this.users));
        }

        createAccount(username, email, password) {
            if (this.users[username]) {
                return { success: false, message: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„' };
            }
            this.users[username] = {
                email: email,
                password: password,
                workers: []
            };
            this.saveUsers();
            return { success: true, message: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­' };
        }

        login(username, password) {
            const user = this.users[username];
            if (!user || user.password !== password) {
                return { success: false, message: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©' };
            }
            this.currentUser = username;
            this.userData = user;
            return { success: true, message: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­' };
        }

        logout() {
            this.currentUser = null;
            this.userData = {};
        }

        getCurrentUser() {
            return this.currentUser ? {
                username: this.currentUser,
                ...this.userData
            } : null;
        }

        addWorker(workerData) {
            if (!this.currentUser) return { success: false, message: 'Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' };
            if (!workerData.name || !workerData.reportCount || !workerData.reportPrice) {
                return { success: false, message: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„' };
            }
            const worker = {
                id: Date.now(),
                name: workerData.name,
                reportCount: parseFloat(workerData.reportCount),
                reportPrice: parseFloat(workerData.reportPrice),
                paidAmount: parseFloat(workerData.paidAmount) || 0,
                paymentMethod: workerData.paymentMethod || "Ù†Ù‚Ø¯ÙŠ",
                createdAt: new Date().toISOString()
            };
            this.users[this.currentUser].workers.push(worker);
            this.saveUsers();
            this.userData = this.users[this.currentUser];
            return { success: true, message: 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­' };
        }

        updateWorker(workerId, workerData) {
            if (!this.currentUser) return { success: false, message: 'Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' };
            const workers = [...this.userData.workers];
            const workerIndex = workers.findIndex(w => w.id === workerId);
            if (workerIndex === -1) return { success: false, message: 'Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯' };

            workers[workerIndex] = {
                ...workers[workerIndex],
                name: workerData.name,
                reportCount: parseFloat(workerData.reportCount) || 0,
                reportPrice: parseFloat(workerData.reportPrice) || 0,
                paidAmount: parseFloat(workerData.paidAmount) || 0,
                paymentMethod: workerData.paymentMethod || "Ù†Ù‚Ø¯ÙŠ"
            };

            this.users[this.currentUser].workers = workers;
            this.userData = this.users[this.currentUser];
            this.saveUsers();

            return { success: true, message: 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­' };
        }

        deleteWorker(workerId) {
            if (!this.currentUser) return { success: false, message: 'Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' };
            this.users[this.currentUser].workers = this.userData.workers.filter(w => w.id !== workerId);
            this.userData = this.users[this.currentUser];
            this.saveUsers();
            return { success: true, message: 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­' };
        }

        getFilteredWorkers(filters = {}) {
            if (!this.currentUser) return [];
            let result = [...this.userData.workers];

            if (filters.search && filters.search.trim()) {
                const search = filters.search.toLowerCase().trim();
                result = result.filter(worker => worker.name.toLowerCase().includes(search));
            }

            if (filters.status) {
                result = result.filter(worker => {
                    const total = worker.reportCount * worker.reportPrice;
                    const paid = worker.paidAmount;
                    if (filters.status === 'Ù…Ø¯ÙÙˆØ¹') return paid >= total;
                    if (filters.status === 'Ø¬Ø²Ø¦ÙŠ') return paid > 0 && paid < total;
                    if (filters.status === 'Ù„Ù… ÙŠØ¯ÙØ¹') return paid <= 0;
                    return true;
                });
            }

            if (filters.paymentMethod) {
                result = result.filter(worker => worker.paymentMethod === filters.paymentMethod);
            }

            return result;
        }

        clearAllWorkers() {
            if (!this.currentUser) return { success: false, message: 'Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' };
            if (window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                this.users[this.currentUser].workers = [];
                this.userData = this.users[this.currentUser];
                this.saveUsers();
                return { success: true, message: 'ØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­' };
            }
            return { success: false, message: 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø³Ø­' };
        }
    }

    const dataManager = new DataManager();

    function showCreateAccount() {
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('createAccountScreen').classList.remove('hidden');
        document.getElementById('createAccountScreen').style.display = 'block';
    }

    function showLogin() {
        document.getElementById('createAccountScreen').classList.add('hidden');
        document.getElementById('createAccountScreen').style.display = 'none';
        document.getElementById('loginScreen').style.display = 'block';
    }

    function showAlert(elementId, message, isSuccess = true) {
        const alertDiv = document.getElementById(elementId);
        alertDiv.innerHTML = `
            <div class="alert ${isSuccess ? 'alert-success' : 'alert-error'}">${message}</div>
        `;
        setTimeout(() => {
            alertDiv.innerHTML = '';
        }, 5000);
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('loginUsername').value.trim();
        const password = document.getElementById('loginPassword').value.trim();
        const result = dataManager.login(username, password);
        if (result.success) {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainScreen').style.display = 'block';
            document.getElementById('currentUserName').textContent = username;
            updateWorkersTable();
        } else {
            showAlert('loginAlert', result.message, false);
        }
    });

    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
    document.getElementById('createAccountForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('createUsername').value.trim();
        const email = document.getElementById('createEmail').value.trim();
        const password = document.getElementById('createPassword').value.trim();
        const confirmPassword = document.getElementById('confirmPassword').value.trim();
        if (password !== confirmPassword) {
            showAlert('createAlert', 'ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†', false);
            return;
        }
        const result = dataManager.createAccount(username, email, password);
        if (result.success) {
            showAlert('createAlert', result.message, true);
            setTimeout(() => {
                showLogin();
            }, 2000);
        } else {
            showAlert('createAlert', result.message, false);
        }
    });

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    function logout() {
        if (window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
            dataManager.logout();
            document.getElementById('mainScreen').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }
    }

    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
    function addWorker() {
        document.getElementById('workerName').value = '';
        document.getElementById('reportCount').value = 0;
        document.getElementById('reportPrice').value = 0;
        document.getElementById('paidAmount').value = 0;
        document.getElementById('paymentMethod').value = 'Ù†Ù‚Ø¯ÙŠ';
        document.getElementById('workerModal').style.display = 'block';
    }

    function closeModal() {
        document.getElementById('workerModal').style.display = 'none';
    }

    document.getElementById('workerForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const workerData = {
            name: document.getElementById('workerName').value.trim(),
            reportCount: document.getElementById('reportCount').value,
            reportPrice: document.getElementById('reportPrice').value,
            paidAmount: document.getElementById('paidAmount').value,
            paymentMethod: document.getElementById('paymentMethod').value
        };
        const result = dataManager.addWorker(workerData);
        if (result.success) {
            showAlert('createAlert', result.message, true);
            closeModal();
            updateWorkersTable();
        } else {
            showAlert('createAlert', result.message, false);
        }
    });
function exportToExcel() {
    const table = document.getElementById("workersTable");
    const htmlTable = table.cloneNode(true); // Ù†Ø³Ø® Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£ØµÙ„ÙŠ
    const newHeader = document.createElement("tr");

    // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¹Ù†ÙˆØ§Ù† Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
    const titleCell = document.createElement("td");
    titleCell.setAttribute("colspan", table.rows[0].cells.length);
    titleCell.textContent = "Ù…ÙƒØªØ¨ Ù…Ø§Ø³ØªØ± Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª - ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡";
    titleCell.style.fontSize = "16px";
    titleCell.style.fontWeight = "bold";
    titleCell.style.textAlign = "center";

    const headerRow = htmlTable.querySelector("thead tr");
    headerRow.parentNode.insertBefore(newHeader, headerRow);
    const titleRow = document.createElement("tr");
    const titleCellWrapper = document.createElement("td");
    titleCellWrapper.setAttribute("colspan", table.rows[0].cells.length);
    titleCellWrapper.appendChild(titleCell);
    titleRow.appendChild(titleCellWrapper);
    headerRow.parentNode.insertBefore(titleRow, headerRow);

    // Ø¥Ø¶Ø§ÙØ© ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØµØ¯ÙŠØ±
    const dateRow = document.createElement("tr");
    const dateCell = document.createElement("td");
    dateCell.setAttribute("colspan", table.rows[0].cells.length);
    dateCell.textContent = `ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØµØ¯ÙŠØ±: ${new Date().toLocaleString()}`;
    dateCell.style.fontSize = "12px";
    dateCell.style.color = "#888";
    dateRow.appendChild(dateCell);
    headerRow.parentNode.insertBefore(dateRow, headerRow.nextSibling);

    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„ Excel
    const ws = XLSX.utils.table_to_sheet(htmlTable);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡");
    XLSX.writeFile(wb, `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡_${new Date().toISOString().split('T')[0]}.xlsx`);
}
    // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„
    function editWorker(workerId) {
        const currentUser = dataManager.getCurrentUser();
        if (!currentUser) return;

        const worker = currentUser.workers.find(w => w.id === workerId);
        if (!worker) {
            showAlert('createAlert', 'Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', false);
            return;
        }

        document.getElementById('workerId').value = worker.id;
        document.getElementById('workerNameEdit').value = worker.name;
        document.getElementById('reportCountEdit').value = worker.reportCount;
        document.getElementById('reportPriceEdit').value = worker.reportPrice;
        document.getElementById('paidAmountEdit').value = worker.paidAmount;
        document.getElementById('paymentMethodEdit').value = worker.paymentMethod;

        document.getElementById('workerEditModal').style.display = 'block';
    }

    function closeEditModal() {
        document.getElementById('workerEditModal').style.display = 'none';
    }

    document.getElementById('workerEditForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const workerData = {
            id: parseInt(document.getElementById('workerId').value),
            name: document.getElementById('workerNameEdit').value.trim(),
            reportCount: document.getElementById('reportCountEdit').value,
            reportPrice: document.getElementById('reportPriceEdit').value,
            paidAmount: document.getElementById('paidAmountEdit').value,
            paymentMethod: document.getElementById('paymentMethodEdit').value
        };

        const result = dataManager.updateWorker(workerData.id, workerData);
        if (result.success) {
            showAlert('createAlert', result.message, true);
            closeEditModal();
            updateWorkersTable();
        } else {
            showAlert('createAlert', result.message, false);
        }
    });

    // Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„
    function deleteWorker(workerId) {
        if (window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŸ')) {
            const result = dataManager.deleteWorker(workerId);
            if (result.success) {
                showAlert('createAlert', result.message, true);
                updateWorkersTable();
            } else {
                showAlert('createAlert', result.message, false);
            }
        }
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„
    function updateWorkersTable() {
        const currentUserData = dataManager.getCurrentUser();
        if (!currentUserData) return;

        const filters = {
            search: document.getElementById('searchFilter').value,
            status: document.getElementById('statusFilter').value,
            paymentMethod: document.getElementById('paymentMethodFilter').value
        };

        const workers = dataManager.getFilteredWorkers(filters);

        const tableBody = document.getElementById('workersTableBody');
        tableBody.innerHTML = '';

        let totalReports = 0;
        let totalAmount = 0;
        let totalPaid = 0;
        let totalCommission = 0;
        let totalNetPaid = 0;
        let totalRemaining = 0;

        workers.forEach(worker => {
            const amount = worker.reportCount * worker.reportPrice;
            const paid = worker.paidAmount;
            const remaining = amount - paid;

            let commission = 0;
            if (worker.paymentMethod === 'Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ') commission = paid * 0.00;
            if (worker.paymentMethod === 'ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´') commission = paid * 0.01;
            const netPaid = paid - commission;

            totalReports += parseInt(worker.reportCount);
            totalAmount += amount;
            totalPaid += paid;
            totalCommission += commission;
            totalNetPaid += netPaid;
            totalRemaining += remaining;

            let statusClass = '';
            if (paid >= amount) statusClass = 'status-paid';
            else if (paid > 0) statusClass = 'status-partial';
            else statusClass = 'status-unpaid';

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${worker.name}</td>
                <td>${worker.reportCount}</td>
                <td>${worker.reportPrice.toFixed(2)}</td>
                <td>${amount.toFixed(2)}</td>
                <td>${worker.paidAmount.toFixed(2)}</td>
                <td>${worker.paymentMethod}</td>
                <td class="commission-cell">${commission.toFixed(2)}</td>
                <td class="net-paid-cell">${netPaid.toFixed(2)}</td>
                <td class="${remaining > 0 ? 'commission-cell' : ''}">${remaining.toFixed(2)}</td>
                <td><div class="status-cell ${statusClass}">${paid >= amount ? 'Ù…Ø¯ÙÙˆØ¹' : paid > 0 ? 'Ø¬Ø²Ø¦ÙŠ' : 'Ù„Ù… ÙŠØ¯ÙØ¹'}</div></td>
                <td>${new Date(worker.createdAt).toLocaleDateString()}</td>
                <td>
                    <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;" onclick="editWorker(${worker.id})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                    <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px; margin-left: 5px;" onclick="deleteWorker(${worker.id})">âŒ Ø­Ø°Ù</button>
                </td>
            `;
            tableBody.appendChild(row);
        });

        document.getElementById('totalReportsFooter').innerHTML = `<strong>${totalReports}</strong>`;
        document.getElementById('totalAmountFooter').innerHTML = `<strong>${totalAmount.toFixed(2)}</strong>`;
        document.getElementById('totalPaidFooter').innerHTML = `<strong>${totalPaid.toFixed(2)}</strong>`;
        document.getElementById('totalCommissionFooter').innerHTML = `<strong>${totalCommission.toFixed(2)}</strong>`;
        document.getElementById('totalNetPaidFooter').innerHTML = `<strong>${totalNetPaid.toFixed(2)}</strong>`;
        document.getElementById('totalRemainingFooter').innerHTML = `<strong>${totalRemaining.toFixed(2)}</strong>`;
        document.getElementById('totalWorkers').textContent = workers.length;
        document.getElementById('totalReports').textContent = totalReports;
        document.getElementById('totalAmount').textContent = `${totalAmount.toFixed(2)} Ø¬Ù†ÙŠÙ‡`;
        document.getElementById('totalPaid').textContent = `${totalPaid.toFixed(2)} Ø¬Ù†ÙŠÙ‡`;
        document.getElementById('totalCommission').textContent = `${totalCommission.toFixed(2)} Ø¬Ù†ÙŠÙ‡`;
        document.getElementById('totalNetPaid').textContent = `${totalNetPaid.toFixed(2)} Ø¬Ù†ÙŠÙ‡`;
        document.getElementById('totalRemaining').textContent = `${totalRemaining.toFixed(2)} Ø¬Ù†ÙŠÙ‡`;
        document.getElementById('collectionRate').textContent = totalAmount > 0 ? ((totalPaid / totalAmount) * 100).toFixed(1) + '%' : '0%';
    }

    // Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
    function clearAll() {
        if (window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
            dataManager.clearAllWorkers();
            updateWorkersTable();
        }
    }

    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
    function applyFilters() {
        updateWorkersTable();
    }

    function clearFilters() {
        document.getElementById('searchFilter').value = '';
        document.getElementById('statusFilter').value = '';
        document.getElementById('paymentMethodFilter').value = '';
        updateWorkersTable();
    }

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.onload = function () {
        const currentUser = dataManager.getCurrentUser();
        if (currentUser) {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainScreen').style.display = 'block';
            document.getElementById('currentUserName').textContent = currentUser.username;
            updateWorkersTable();
        }
    };
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script> 
</body>
</html>
